안녕하세요, 서울게임아카데미 게임프로그래밍반 IOTA 팀 김정훈입니다.
이번 팀포트폴리오는 고전게임 삼국지 조조전을 모작하여 만들었습니다.

--PPT
-ppt 역할분담
저희 팀원은 김정훈, 한규현, 이동희, 박현준, 허경일, 이한얼 총 6명이며
각자 역할분담은 위와 같습니다.

-ppt 클래스 구조
이번 프로젝트에서는 이미지 회전이 필요하지 않아 winAPI GDI로 제작하였습니다.
씬은 크게 Init, Select, Sotry, Ready, Battle, UnitEditor, MapTool 으로 구성하였습니다.

Unit(Player, Friend, Enemy)과 Map 은 mainGame 맴버변수로 선언하여 각 씬들에서
접근하기 쉽도록 하였습니다.

--GAME
-init(loading)
게임을 처음 실행하면 게임 내 사용할 리소스(이미지, 사운드)를 로딩하는 작업을 하였으며,
리소스 이름과, 프로그래스바로 진행상황을 표현하였습니다.

-Select
로딩이 끝나면 자동으로 선택씬으로 넘어오고, 
게임시작, 맵편집, 유닛편집으로 넘어갈 수 있습니다.
그리고 씬들이 윈도우 사이즈가 달라서 씬을 이동할때마다 윈도우 사이즈를 변경하도록 하였습니다.
우선 맵편집먼저 보여드리겠습니다.

-MapTool
처음에는 기본으로 터레인 0번인 강을 보여주게 되며,
우측 하단에 있는 맵 번호를 입력한 뒤 불러오기를 통해 사용할 맵을 불러올 수 있습니다.
이번 프로젝트에서 에디트박스 클래스를 만들어서 window message 중에 WM_CHAR 가 입력되면 받아도록 하였습니다.
조조전 게임 내 맵은 총 58개이며 0~57의 숫자를 입력받고 그보다 큰 값을 받으면 최대값인 57이 되도록 하였습니다.
반대로 0보다 작은 숫자를 입력하면 0이 되게 하였습니다.
숫자를 입력하고 불러오기를 누르면 해당 맵의 이미지와 맵타일정보를 불러오고, 
미리 저장된 이미지에 해상도에 맞춰 최대크기가 변경되게 해 두었습니다.
실제 인게임 맵의 이미지는 TAB 키로 토글하여 show/hide 할 수 있도록 하였으며, 우측 하단에 투명도로 설정하도록 하였습니다.
이 기능으로 맵 이미지를 보면서 맵타일에 타일 속성을 주도록 하였습니다.
속성은 enum문을 사용해 부여했으며 T키를 누르면 해당 번호가 출력되도록 했습니다.
실행 취소(Ctrl+Z)와 다시 실행(Ctrl+Y)을 구현하였으며 list를 사용해 마우스를 떼었을 때의 상태를 저장해 넣었습니다.
기본적으로 _lSave라는 list에 저장이 되게 했으며 무한히 저장되는 것을 방지하고자 최대 100개까지의 행동을 저장되게 했습니다.
실행 취소를 했을 시 _lBackUp이라는 list에 실행 취소된 작업들을 저장을 하고 다시 실행을 했을 시에 불러오게 했습니다.
또 실행취소 된 상태에서 새로운 작업을 실행하면 _lBackUp을 clear()시켜 오류를 방지했습니다.
다른 맵을 로드했을 시에도 _lSave와 _lBackUp을 clear()시켜 로드하기 이전으로 되돌아 가지 않게 했습니다.
선택된 지형 및 유닛을 표시해두었으며, 지우기를 클릭할 시 유닛을 지울 수 있게 해두었습니다.
기본적으로 유닛이 그려진 곳에는 또다른 유닛이 그려지지 않게 했고, 유닛을 클릭하면 표시가 되며
우측 중단에 있는 에디트 박스에 해당 유닛을 불러오게 했으며,
에디트박스에 원하는 이름을 적고 save버튼을 누르면 유닛에 이름이 저장되고 화면에 나오도록 했습니다.
이렇게 배치된 유닛들은 게임내에서 실제로 유닛들을 배치할 위치로 사용됩니다.
마지막으로 나가기 버튼을 누르면 메인화면으로 되돌아 갑니다.

->다시 선택씬으로
다음은 유닛에디터씬을 보여드리겠습니다.

-UnitEditor
처음에 삼국지 조조전으로 타겟을 잡은 후에 가장 걱정되었던 부분이 수많은 영웅 유닛들이였습니다.
유닛들을 모두 클래스로 선언하기에는 무리가 있다 판다하여 유닛에디터를 만들게 되었습니다.
유닛에디터에서는 유닛의 전투정보 외에 기본적으로 생성하는데 필요한 정보들을 입력하여 저장하고, 불러올 수 있도록 하였습니다.
유닛들은 기본적으로 팀(플레이어, 아군, 적군)으로 폴더가 나뉘어져 있으며, 각 폴더내에 있는 모든 유닛 데이터들을 불러옵니다.
저장하는 정보들은 얼굴이미지, 전투이미지, 텍스트정보, 이동력, 전투 스텟, 전투공격범위 등이 있습니다.
얼굴이미지, 전투이미지는 리소스 파일을 순번대로 돌리며, 원하는 이미지로 선택하도록 하였습니다.
장수 텍스트 정보는 에디트박스를 사용하였으며, 숫자만 입력하는 경우 숫자만 입력받도록 하였으며 min/max를 설정하여 값을 클램핑하였습니다.
공격범위는 유닛 중심 기준 7x7 타일에서 공격 가능한 범위를 클릭하여 토글입력하도록 하였습니다.
마지막으로 저장이름에 입력하고 저장을 하면 저장되는것을 확인할 수 있습니다.
나가기를 누르면 다시 선택씬으로 이동합니다.

->다시 선택씬으로
저희는 삼국지 조조전 3번째 전투를 구현하였으며, 게임시작을 누르면 스토리씬으로 이동합니다.

-Story
스토리씬은 스크립트 형식으로, 대화내용을 저장한 텍스트 fopen, fgets, fclose 를 사용하여 마우스 클릭할때마다 읽어오도록 하였습니다.
script파일에서 대화의 내용 뿐만 아니라 대화창의 위치, 대화창 종류(얼굴 좌/우 배치), script 파일 변경, 대화유닛 이동 등의 명령도 받아 처리하도록 하였습니다.
그리고 이 대화창은 스토리씬 뿐만 아니라, 전투대기씬, 전투씬에서도 사용하도록 하였습니다.
맵은 유닛들이 대각선으로 움직이도록 isoMetric 타일을 배치하고, 타일 위치를 기준으로 움직이도록 하였습니다.
대화가 모두 끝나면 전투대기씬으로 이동합니다.

-Ready
아아.. 저 패기 넘치는 양쌤.. (찡긋)
전투대기씬은 


-Battle




-result(end)


